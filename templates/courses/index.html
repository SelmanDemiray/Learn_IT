{% extends "base.html" %}

{% block title %}Courses - IT Learning Platform{% endblock %}

{% block content %}
<div class="courses-container">
    <div class="page-header">
        <h1>IT Learning Courses</h1>
        <p class="subtitle">Select a course to begin your learning journey</p>
        
        <div class="level-filters">
            <button class="filter-button active" onclick="filterCourses('all')">All Levels</button>
            <button class="filter-button beginner-filter" onclick="filterCourses('beginner')">Beginner</button>
            <button class="filter-button intermediate-filter" onclick="filterCourses('intermediate')">Intermediate</button>
            <button class="filter-button advanced-filter" onclick="filterCourses('advanced')">Advanced</button>
        </div>
    </div>
    
    <!-- Check if courses exist before rendering -->
    {% if beginner_courses %}
    <section class="course-section beginner-section">
        <div class="section-header">
            <h2>Beginner Courses</h2>
            <p>Perfect starting points for those new to IT</p>
        </div>
        <div class="course-grid">
            {% for course in beginner_courses %}
            <a href="/courses/{{ course.id }}" class="course-card" data-level="{{ course.level|default(value='beginner') }}">
                <div class="course-card-header beginner">
                    <div class="level-badge beginner">Beginner</div>
                    <div class="course-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                    </div>
                </div>
                <div class="course-card-body">
                    <h3 class="course-card-title">{{ course.title|default(value='Course Title') }}</h3>
                    <p class="course-card-desc">{{ course.description|default(value='Course description') }}</p>
                    <div class="course-card-footer">
                        <div class="course-card-meta">
                            <div class="lesson-count">{{ course.lessons|length|default(value=0) }} lessons</div>
                            <div class="estimated-time">~{{ course.lessons|length|default(value=0) | safe }} min</div>
                        </div>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress course-{{ course.id }}" style="width: 0%" data-target-width="{{ course.progress|default(value=0) }}%"></div>
                            </div>
                            <div class="progress-text">
                                {% set progress = course.progress|default(value=0) %}
                                {% if progress > 0 %}
                                    {% if progress == 100 %}Completed{% else %}{{ progress }}% Complete{% endif %}
                                {% else %}
                                    Not started
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if intermediate_courses %}
    <section class="course-section intermediate-section">
        <div class="section-header">
            <h2>Intermediate Courses</h2>
            <p>Build upon your foundational knowledge</p>
        </div>
        <div class="course-grid">
            {% for course in intermediate_courses %}
            <a href="/courses/{{ course.id }}" class="course-card" data-level="{{ course.level|default(value='intermediate') }}">
                <div class="course-card-header intermediate">
                    <div class="level-badge intermediate">Intermediate</div>
                    <div class="course-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                    </div>
                </div>
                <div class="course-card-body">
                    <h3 class="course-card-title">{{ course.title|default(value='Course Title') }}</h3>
                    <p class="course-card-desc">{{ course.description|default(value='Course description') }}</p>
                    <div class="course-card-footer">
                        <div class="course-card-meta">
                            <div class="lesson-count">{{ course.lessons|length|default(value=0) }} lessons</div>
                            <div class="estimated-time">~{{ course.lessons|length|default(value=0) | safe }} min</div>
                        </div>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress course-{{ course.id }}" style="width: 0%" data-target-width="{{ course.progress|default(value=0) }}%"></div>
                            </div>
                            <div class="progress-text">
                                {% set progress = course.progress|default(value=0) %}
                                {% if progress > 0 %}
                                    {% if progress == 100 %}Completed{% else %}{{ progress }}% Complete{% endif %}
                                {% else %}
                                    Not started
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if advanced_courses %}
    <section class="course-section advanced-section">
        <div class="section-header">
            <h2>Advanced Courses</h2>
            <p>Master complex concepts and specialized skills</p>
        </div>
        <div class="course-grid">
            {% for course in advanced_courses %}
            <a href="/courses/{{ course.id }}" class="course-card" data-level="{{ course.level|default(value='advanced') }}">
                <div class="course-card-header advanced">
                    <div class="level-badge advanced">Advanced</div>
                    <div class="course-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                    </div>
                </div>
                <div class="course-card-body">
                    <h3 class="course-card-title">{{ course.title|default(value='Course Title') }}</h3>
                    <p class="course-card-desc">{{ course.description|default(value='Course description') }}</p>
                    <div class="course-card-footer">
                        <div class="course-card-meta">
                            <div class="lesson-count">{{ course.lessons|length|default(value=0) }} lessons</div>
                            <div class="estimated-time">~{{ course.lessons|length|default(value=0) | safe }} min</div>
                        </div>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress course-{{ course.id }}" style="width: 0%" data-target-width="{{ course.progress|default(value=0) }}%"></div>
                            </div>
                            <div class="progress-text">
                                {% set progress = course.progress|default(value=0) %}
                                {% if progress > 0 %}
                                    {% if progress == 100 %}Completed{% else %}{{ progress }}% Complete{% endif %}
                                {% else %}
                                    Not started
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</div>

<script>
function filterCourses(level) {
    // Update active button
    document.querySelectorAll('.level-filters .filter-button').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Show/hide course sections
    const sections = document.querySelectorAll('.course-section');
    sections.forEach(section => {
        if (level === 'all') {
            section.style.display = 'block';
        } else {
            const sectionLevel = section.classList.contains(`${level}-section`);
            section.style.display = sectionLevel ? 'block' : 'none';
        }
    });
}

// Animate progress bars on page load
document.addEventListener('DOMContentLoaded', function() {
    const progressBars = document.querySelectorAll('.progress');
    progressBars.forEach(bar => {
        const targetWidth = bar.getAttribute('data-target-width') || bar.style.width;
        bar.style.width = '0%';
        setTimeout(() => {
            bar.style.transition = 'width 1s ease-in-out';
            bar.style.width = targetWidth;
        }, 500);
    });
});
</script>
{% endblock %}
